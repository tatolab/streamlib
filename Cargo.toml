[workspace]
resolver = "2"
members = [
    "xtask",                    # Development tasks (cargo xtask <command>)
    "libs/streamlib",           # All-in-one: core, apple (feature-gated)
    "libs/streamlib-broker",    # Broker service for cross-process coordination (macOS)
    "libs/streamlib-cli",       # Command-line interface for StreamLib runtime
    "libs/streamlib-codegen-shared", # Execution types shared between streamlib and streamlib-macros
    "libs/streamlib-macros",    # Procedural macros for reducing boilerplate
    "libs/streamlib-plugin-abi", # ABI-stable FFI types for dynamic plugins
    # "libs/streamlib-python",    # Python bindings via PyO3 (temporarily disabled - host processors obsolete with multi-runtime architecture)
    "libs/streamlib-schema",    # Schema definition, parsing, and code generation
    # TODO: Migrate to iceoryx2 API - these examples depend on processors that haven't been migrated yet
    # "examples/simple-pipeline", # Example: Basic processing pipeline (uses AudioOutputProcessor)
    "examples/camera-display",  # Example: Camera capture and display (uses CameraProcessor, DisplayProcessor)
    # "examples/camera-audio-recorder", # Example: Record camera + audio to MP4 (uses camera, audio, mp4 writer)
    # "examples/microphone-reverb-speaker", # Example: Audio processing with CLAP (uses audio capture, clap, audio output)
    # "examples/audio-mixer-demo", # Example: Mixing multiple audio streams (uses AudioOutputProcessor)
    # "examples/webrtc-cloudflare-stream", # Example: WebRTC streaming to Cloudflare (uses WebRTC WHIP)
    # "examples/whep-player",     # Example: WHEP (WebRTC egress) player (uses WebRTC WHEP)
    # "examples/runtime-graph-json-demo",   # Example: Runtime graph JSON serialization (uses CameraProcessor, etc.)
    # "examples/graph-json-export",         # Example: Graph data structure JSON export (uses custom processors with old syntax)
    "examples/api-server",                # Example: Minimal API server (runtime + wait_for_signal)
    "examples/api-server-demo",           # Example: API server processor demo
    "examples/tokio-integration",         # Example: StreamRuntime with existing tokio runtime
    # "examples/camera-python-display",     # Example: Camera → Python → Display pipeline (temporarily disabled - depends on streamlib-python)
    # "examples/camera-dylib-display",      # Example: Camera → Dylib plugins → Display pipeline (temporarily disabled - depends on streamlib-python)
    # "examples/camera-dylib-display/rust", # Plugin: Rust processors for camera-dylib-display
]

[workspace.package]
version = "0.2.5"
edition = "2021"
authors = ["Jonathan Fontanez <fontanezj1@gmail.com>"]
license-file = "LICENSE"
repository = "https://github.com/tato123/streamlib"

[workspace.dependencies]
# Core dependencies
thiserror = "2.0.17"
anyhow = "1.0.100"
tracing = "0.1.41"
tokio = { version = "1.48.0", features = ["full"] }

# Serialization
serde = { version = "1.0", features = ["derive"] }
serde_json = { version = "1.0", features = ["preserve_order"] }
serde_yaml = "0.9"
toml = "0.8"
rmp-serde = "1.3"

# Hashing
sha2 = "0.10"

# Platform bindings (objc2 ecosystem - latest versions)
# Note: All objc2 crates must use compatible versions
objc2 = "0.6.3"
objc2-metal = "0.3.2"
objc2-io-surface = "0.3.2"
objc2-core-foundation = "0.3.2"
objc2-core-video = "0.3.2"
objc2-core-media = "0.3.2"
objc2-foundation = "0.3.2"
objc2-av-foundation = "0.3.2"
objc2-app-kit = "0.3.2"
objc2-quartz-core = "0.3.2"
objc2-core-text = "0.3.2"
objc2-core-graphics = "0.3.2"
objc2-vision = "0.3.2"
libc = "0.2.177"

# Shader compilation
# TODO: Add when implementing HLSL shader compilation:
#   - hassle-rs (DXC wrapper for HLSL → SPIR-V)
#   - spirv-cross-rs (SPIR-V → Metal/Vulkan)

# WebRTC
str0m = "0.11.1"

# HTTP/Web
axum = { version = "0.8.8", features = ["ws"] }
tower-http = "0.6.8"
hyper = "1.7.0"


# YUV/RGB conversion - REMOVED (now using GPU-accelerated VTPixelTransferSession)
# yuv = "0.8"
